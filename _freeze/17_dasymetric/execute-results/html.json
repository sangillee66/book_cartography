{
  "hash": "b3c54c6c3c8525566b4407ec4351b77b",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"대시메트릭맵\"\nauthor: Sang-Il Lee\ndate-modified: last-modified\nnumber-sections: true\nformat: \n  html: \n    toc: true\ncode-link: true\ncode-copy: true\nexecute: \n  warning: false\n  error: false\n  freeze: auto\neditor: visual\neditor_options: \n  chunk_output_type: console\n---\n\n\n## 대시메트릭 매핑의 원리\n\n## 대시메트릭 맵의 작성\n\n### 서울시 인구분포\n\n#### 일반 데이터\n\n-   필수 패키지\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse) \nlibrary(readxl) \nlibrary(sf) \nlibrary(tmap) \n```\n:::\n\n\n-   도형 데이터: 서울 행정구역\n\n\n::: {.cell}\n\n```{.r .cell-code}\nseoul_EMD_2020 <- st_read(\n  \"D:/My R/Korean Administrative Areas/행정구역 셰이프 파일/2 Original Cleaning/2020_2Q/SEOUL_EMD_2020_2Q.shp\", options = \"ENCODING=CP949\"\n  ) \nseoul_gu <- st_read(\n  \"D:/My R/Korean Administrative Areas/행정구역 셰이프 파일/2 Original Cleaning/2021_4Q/SEOUL_GU_2021_4Q.shp\", options = \"ENCODING=CP949\"\n  ) \nseoul_sido <- st_read(\n  \"D:/My R/Korean Administrative Areas/행정구역 셰이프 파일/2 Original Cleaning/2021_4Q/SEOUL_SIDO_2021_4Q.shp\", options = \"ENCODING=CP949\"\n  )\n```\n:::\n\n\n-   속성 데이터\n\n\n::: {.cell}\n\n```{.r .cell-code}\npop_SDGGEMD_2020 <- read_excel(\n  \"D:/My R/Korea Census Data Manipulation/1 Population Basic/DM_ADJ_Census_2020.xlsx\", sheet = 1\n  )\n```\n:::\n\n\n-   결합 및 인구밀도 계산\n\n\n::: {.cell}\n\n```{.r .cell-code}\nseoul_EMD_2020 <- seoul_EMD_2020 |> \n  mutate(\n    EMD_ID = as.numeric(EMD_ID)\n  )\nmy_df <-seoul_EMD_2020 |> \n  left_join(\n    pop_SDGGEMD_2020, join_by(EMD_ID == Code)\n  )\nmy_df$area <- st_area(my_df) / 1000000\nmy_df <- my_df |> \n  mutate(\n    pop_den_t = pop_t / area\n  )\n```\n:::\n\n\n#### 토지피복지도 생성\n\n-   데이터: 2023년 중분류(1:25,000) 정리된 것 불러오기\n\n\n::: {.cell}\n\n```{.r .cell-code}\nseoul_landcover <- st_read(\"D:/My R/Vector Data Manipulation Korea/Korea_Landcover/seoul_landcover_M_2023.shp\", options = \"ENCODING=CP949\")\nqtm(seoul_landcover)\n```\n\n::: {.cell-output-display}\n![](17_dasymetric_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n-   색상의 지정: <https://egis.me.go.kr/intro/land.do>\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlandcover_color <- c(\"주거지역\" = \"#fee6c2\",\n                     \"공업지역\" = \"#c08484\",\n                     \"상업지역\" = \"#ed83b8\", \n                     \"문화·체육·휴양지\" = \"#f67189\",\n                     \"교통지역\" = \"#f7422a\",\n                     \"공공시설지역\" = \"#f6b212\",\n                     \"논\" = \"#ffffbf\", \n                     \"밭\" = \"#f7f966\",\n                     \"시설재배지\" = \"#dfdb73\",\n                     \"과수원\" = \"#b8b12c\",\n                     \"기타재배지\" = \"#b89112\",\n                     \"활엽수림\" = \"#34a02c\",\n                     \"침엽수림\" = \"#0a4f40\",\n                     \"혼효림\" = \"#336633\",\n                     \"자연초지\" = \"#a1d594\",\n                     \"인공초지\" = \"#607e33\",\n                     \"내륙습지\" = \"#b4a7d0\",\n                     \"연안습지\" = \"#997499\",\n                     \"자연나지\" = \"#c1dbec\",\n                     \"인공나지\" = \"#9ff2ff\",\n                     \"내륙수\" = \"#3ea8ff\", \n                     \"해양수\" = \"#1739ff\"\n)\n```\n:::\n\n\n-   지도 제작\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_map <- tm_shape(seoul_landcover) + \n  tm_polygons(col = \"L2_NAME\", style = \"cat\", palette = landcover_color, border.alpha = 0, legend.show = FALSE) +\n  tm_shape(seoul_gu) + tm_borders() +\n  tm_scale_bar(\n    color.dark = \"gray60\",\n    text.size = 0.25,\n    breaks = seq(0, 10, 2),\n    position = c(0.03, 0.01)) + \n  tm_credits(\n    \"SANG-IL LEE, Geography Education at SNU, 2024\", \n    size = 0.3, position = c(0.78, 0.01)\n  )\nmy_map\n```\n\n::: {.cell-output-display}\n![](17_dasymetric_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n-   저장\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_title <- \"17_1_02\"\nmy.path.name <- \"D:/R_Books/Cartography/outputs/\"\nmy.file.name <- paste0(my.path.name, my_title, \".png\")\ntmap_save(\n  my_map, \n  filename = my.file.name, \n  width = 5.75, \n  dpi = 1200)\n```\n:::\n\n\n#### 대시메트릭 매핑\n\n-   가공\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 데이터 추출: 주거지역과 상업지역만 추출\nseoul_landcover_1 <- seoul_landcover |> \n  filter(\n    L2_NAME %in% c(\"주거지역\", \"상업지역\")\n  )\n# qtm(seoul_landcover_1)\n\n# 데이터 유니언\nseoul_landcover_2 <- st_union(seoul_landcover_1) |> \n  st_as_sf()\n# qtm(seoul_landcover_2)\n\n# 데이터 인터섹션: 토지피복도(주거와 상업만)를 동으로 분할하고, 속성을 전이함\nseoul_landcover_3 <- st_intersection(seoul_landcover_2, my_df) |> \n  st_as_sf()\n# qtm(seoul_landcover_3)\n```\n:::\n\n\n-   인구밀도 재계산\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 면적 계산: 동별 주거와 상업의 면적 계산\nseoul_landcover_3$area <- st_area(seoul_landcover_3) / 1000000\n\n# 인구밀도 계산\nseoul_landcover_3 <- seoul_landcover_3 |> \n  mutate(\n    pop_den_t = pop_t / area\n  )\n```\n:::\n\n\n-   지도 제작\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_map <- tm_shape(seoul_gu) + tm_borders() +\n  tm_shape(seoul_landcover_3) + \n  tm_polygons(col = \"pop_den_t\", style = \"fixed\", palette = \"Oranges\", \n              border.alpha = 0,\n              breaks = c(-Inf, 10000, 15000, 20000, 25000, 30000, 40000, Inf), legend.show = FALSE\n              ) +\n  tm_scale_bar(\n    color.dark = \"gray60\",\n    text.size = 0.25,\n    breaks = seq(0, 10, 2),\n    position = c(0.03, 0.01)) + \n  tm_credits(\n    \"SANG-IL LEE, Geography Education at SNU, 2024\", \n    size = 0.3, position = c(0.78, 0.01)\n  )\nmy_map\n```\n\n::: {.cell-output-display}\n![](17_dasymetric_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n-   저장\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_title <- \"17_1_01\"\nmy.path.name <- \"D:/R_Books/Cartography/outputs/\"\nmy.file.name <- paste0(my.path.name, my_title, \".png\")\ntmap_save(\n  my_map, \n  filename = my.file.name, \n  width = 5.75, \n  dpi = 1200)  \n```\n:::\n\n\n#### 점밀도도 대시매트릭 매핑\n\n-   포인트 생성\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_seoul_point <- seoul_landcover_3 |> \n  st_sample(size = round(seoul_landcover_3$pop_t/500), \n            type = \"random\", exact = TRUE) |> \n  st_sf()\n```\n:::\n\n\n-   지도 제작\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_map <- tm_shape(my_df) + \n  tm_borders(col = \"gray10\", lwd = 0.25) +\n  tm_shape(my_seoul_point) + \n  tm_dots(size = 0.005, alpha = 0.75, col = \"#a63603\") +\n  tm_shape(seoul_gu) + tm_borders(col = \"gray10\", lwd = 0.75) +\n  tm_scale_bar(\n    color.dark = \"gray60\",\n    text.size = 0.25,\n    breaks = seq(0, 10, 2),\n    position = c(0.03, 0.01)) + \n  tm_credits(\n    \"SANG-IL LEE, Geography Education at SNU, 2024\", \n    size = 0.3, position = c(0.78, 0.01)\n  )\nmy_map\n```\n\n::: {.cell-output-display}\n![](17_dasymetric_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n-   저장\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_title <- \"17_1_03\"\nmy.path.name <- \"D:/R_Books/Cartography/outputs/\"\nmy.file.name <- paste0(my.path.name, my_title, \".png\")\ntmap_save(\n  my_map, \n  filename = my.file.name, \n  width = 5.75, \n  dpi = 1200)\n```\n:::\n\n---\ntitle: \"대시메트릭맵\"\nauthor: Sang-Il Lee\ndate-modified: last-modified\nnumber-sections: true\nformat: \n  html: \n    toc: true\ncode-link: true\ncode-copy: true\nexecute: \n  warning: false\n  error: false\n  freeze: auto\neditor: visual\neditor_options: \n  chunk_output_type: console\n---\n\n\n## 대시메트릭 매핑의 원리\n\n## 대시메트릭 맵의 작성\n\n### 서울시 인구분포\n\n#### 일반 데이터\n\n-   필수 패키지\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse) \nlibrary(readxl) \nlibrary(sf) \nlibrary(tmap) \n```\n:::\n\n\n-   도형 데이터: 서울 행정구역\n\n\n::: {.cell}\n\n```{.r .cell-code}\nseoul_EMD_2020 <- st_read(\n  \"D:/My R/Korean Administrative Areas/행정구역 셰이프 파일/2 Original Cleaning/2020_2Q/SEOUL_EMD_2020_2Q.shp\", options = \"ENCODING=CP949\"\n  ) \nseoul_gu <- st_read(\n  \"D:/My R/Korean Administrative Areas/행정구역 셰이프 파일/2 Original Cleaning/2021_4Q/SEOUL_GU_2021_4Q.shp\", options = \"ENCODING=CP949\"\n  ) \nseoul_sido <- st_read(\n  \"D:/My R/Korean Administrative Areas/행정구역 셰이프 파일/2 Original Cleaning/2021_4Q/SEOUL_SIDO_2021_4Q.shp\", options = \"ENCODING=CP949\"\n  )\n```\n:::\n\n\n-   속성 데이터\n\n\n::: {.cell}\n\n```{.r .cell-code}\npop_SDGGEMD_2020 <- read_excel(\n  \"D:/My R/Korea Census Data Manipulation/1 Population Basic/DM_ADJ_Census_2020.xlsx\", sheet = 1\n  )\n```\n:::\n\n\n-   결합 및 인구밀도 계산\n\n\n::: {.cell}\n\n```{.r .cell-code}\nseoul_EMD_2020 <- seoul_EMD_2020 |> \n  mutate(\n    EMD_ID = as.numeric(EMD_ID)\n  )\nmy_df <-seoul_EMD_2020 |> \n  left_join(\n    pop_SDGGEMD_2020, join_by(EMD_ID == Code)\n  )\nmy_df$area <- st_area(my_df) / 1000000\nmy_df <- my_df |> \n  mutate(\n    pop_den_t = pop_t / area\n  )\n```\n:::\n\n\n#### 토지피복지도 생성\n\n-   데이터: 2023년 중분류(1:25,000) 정리된 것 불러오기\n\n\n::: {.cell}\n\n```{.r .cell-code}\nseoul_landcover <- st_read(\"D:/My R/Vector Data Manipulation Korea/Korea_Landcover/seoul_landcover_M_2023.shp\", options = \"ENCODING=CP949\")\nqtm(seoul_landcover)\n```\n\n::: {.cell-output-display}\n![](17_dasymetric_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n\n-   색상의 지정: <https://egis.me.go.kr/intro/land.do>\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlandcover_color <- c(\"주거지역\" = \"#fee6c2\",\n                     \"공업지역\" = \"#c08484\",\n                     \"상업지역\" = \"#ed83b8\", \n                     \"문화·체육·휴양지\" = \"#f67189\",\n                     \"교통지역\" = \"#f7422a\",\n                     \"공공시설지역\" = \"#f6b212\",\n                     \"논\" = \"#ffffbf\", \n                     \"밭\" = \"#f7f966\",\n                     \"시설재배지\" = \"#dfdb73\",\n                     \"과수원\" = \"#b8b12c\",\n                     \"기타재배지\" = \"#b89112\",\n                     \"활엽수림\" = \"#34a02c\",\n                     \"침엽수림\" = \"#0a4f40\",\n                     \"혼효림\" = \"#336633\",\n                     \"자연초지\" = \"#a1d594\",\n                     \"인공초지\" = \"#607e33\",\n                     \"내륙습지\" = \"#b4a7d0\",\n                     \"연안습지\" = \"#997499\",\n                     \"자연나지\" = \"#c1dbec\",\n                     \"인공나지\" = \"#9ff2ff\",\n                     \"내륙수\" = \"#3ea8ff\", \n                     \"해양수\" = \"#1739ff\"\n)\n```\n:::\n\n\n-   지도 제작\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_map <- tm_shape(seoul_landcover) + \n  tm_polygons(col = \"L2_NAME\", style = \"cat\", palette = landcover_color, border.alpha = 0, legend.show = FALSE) +\n  tm_shape(seoul_gu) + tm_borders() +\n  tm_scale_bar(\n    color.dark = \"gray60\",\n    text.size = 0.25,\n    breaks = seq(0, 10, 2),\n    position = c(0.03, 0.01)) + \n  tm_credits(\n    \"SANG-IL LEE, Geography Education at SNU, 2024\", \n    size = 0.3, position = c(0.78, 0.01)\n  )\nmy_map\n```\n\n::: {.cell-output-display}\n![](17_dasymetric_files/figure-html/unnamed-chunk-22-1.png){width=672}\n:::\n:::\n\n\n-   저장\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_title <- \"17_1_02\"\nmy.path.name <- \"D:/R_Books/Cartography/outputs/\"\nmy.file.name <- paste0(my.path.name, my_title, \".png\")\ntmap_save(\n  my_map, \n  filename = my.file.name, \n  width = 5.75, \n  dpi = 1200)\n```\n:::\n\n\n#### 대시메트릭 매핑\n\n-   가공\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 데이터 추출: 주거지역과 상업지역만 추출\nseoul_landcover_1 <- seoul_landcover |> \n  filter(\n    L2_NAME %in% c(\"주거지역\", \"상업지역\")\n  )\n# qtm(seoul_landcover_1)\n\n# 데이터 유니언\nseoul_landcover_2 <- st_union(seoul_landcover_1) |> \n  st_as_sf()\n# qtm(seoul_landcover_2)\n\n# 데이터 인터섹션: 토지피복도(주거와 상업만)를 동으로 분할하고, 속성을 전이함\nseoul_landcover_3 <- st_intersection(seoul_landcover_2, my_df) |> \n  st_as_sf()\n# qtm(seoul_landcover_3)\n```\n:::\n\n\n-   인구밀도 재계산\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 면적 계산: 동별 주거와 상업의 면적 계산\nseoul_landcover_3$area <- st_area(seoul_landcover_3) / 1000000\n\n# 인구밀도 계산\nseoul_landcover_3 <- seoul_landcover_3 |> \n  mutate(\n    pop_den_t = pop_t / area\n  )\n```\n:::\n\n\n-   지도 제작\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_map <- tm_shape(seoul_gu) + tm_borders() +\n  tm_shape(seoul_landcover_3) + \n  tm_polygons(col = \"pop_den_t\", style = \"fixed\", palette = \"Oranges\", \n              border.alpha = 0,\n              breaks = c(-Inf, 10000, 15000, 20000, 25000, 30000, 40000, Inf), legend.show = FALSE\n              ) +\n  tm_scale_bar(\n    color.dark = \"gray60\",\n    text.size = 0.25,\n    breaks = seq(0, 10, 2),\n    position = c(0.03, 0.01)) + \n  tm_credits(\n    \"SANG-IL LEE, Geography Education at SNU, 2024\", \n    size = 0.3, position = c(0.78, 0.01)\n  )\nmy_map\n```\n\n::: {.cell-output-display}\n![](17_dasymetric_files/figure-html/unnamed-chunk-26-1.png){width=672}\n:::\n:::\n\n\n-   저장\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_title <- \"17_1_01\"\nmy.path.name <- \"D:/R_Books/Cartography/outputs/\"\nmy.file.name <- paste0(my.path.name, my_title, \".png\")\ntmap_save(\n  my_map, \n  filename = my.file.name, \n  width = 5.75, \n  dpi = 1200)  \n```\n:::\n\n\n#### 점밀도도 대시매트릭 매핑\n\n-   포인트 생성\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_seoul_point <- seoul_landcover_3 |> \n  st_sample(size = round(seoul_landcover_3$pop_t/500), \n            type = \"random\", exact = TRUE) |> \n  st_sf()\n```\n:::\n\n\n-   지도 제작\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_map <- tm_shape(my_df) + \n  tm_borders(col = \"gray10\", lwd = 0.25) +\n  tm_shape(my_seoul_point) + \n  tm_dots(size = 0.005, alpha = 0.75, col = \"#a63603\") +\n  tm_shape(seoul_gu) + tm_borders(col = \"gray10\", lwd = 0.75) +\n  tm_scale_bar(\n    color.dark = \"gray60\",\n    text.size = 0.25,\n    breaks = seq(0, 10, 2),\n    position = c(0.03, 0.01)) + \n  tm_credits(\n    \"SANG-IL LEE, Geography Education at SNU, 2024\", \n    size = 0.3, position = c(0.78, 0.01)\n  )\nmy_map\n```\n\n::: {.cell-output-display}\n![](17_dasymetric_files/figure-html/unnamed-chunk-29-1.png){width=672}\n:::\n:::\n\n\n-   저장\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_title <- \"17_1_03\"\nmy.path.name <- \"D:/R_Books/Cartography/outputs/\"\nmy.file.name <- paste0(my.path.name, my_title, \".png\")\ntmap_save(\n  my_map, \n  filename = my.file.name, \n  width = 5.75, \n  dpi = 1200)\n```\n:::\n",
    "supporting": [
      "17_dasymetric_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}